---
title: 深度学习相关
date: 2025-06-01 10:34:58
updated: 2025-07-15 20:19:21
categories:
  - [服务器&嵌入式平台操作, 基础配置]
tags:
permalink: 深度学习相关/
---

## NVIDIA驱动、CUDA 安装
云服务器在配置时可以选择下载显卡驱动，但是如果后续过程中驱动出现了问题，还是需要手动重装。系统盘扩容之后，运行nvidia-smi，显示错误Failed to initialize NVML: Driver/library version mismatch，这里重装驱动解决。
参考：[在 Ubuntu 18.04 （arm64/aarch64） 下安装 T4 Nvidia 显卡驱动 - Ting011 - 博客园 (cnblogs.com)](https://www.cnblogs.com/tingnote/p/16623213.html)

一些指令可能用到：[ubuntu查看显卡信息、卸载驱动、CUDA - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/243256494)

> [!NOTE] 操作环境
> Ubuntu-22.04 NVIDIA  T4和A10 阿里云服务器 
> 
### 1.卸载现有的驱动程序、安装依赖

```bash
sudo apt-get remove --purge nvidia*
```
安装依赖。(这一步我没用到，可能有用就贴上了)
```bash
sudo apt-get update 
sudo apt-get install g++
sudo apt-get install gcc
sudo apt-get install make
```
### 2.驱动程序下载
输入
```bash
lspci | grep -i nvidia
```
查看显卡型号。到官方网站，选择合适的选项，下载驱动程序。[官方驱动 | NVIDIA](https://www.nvidia.cn/Download/index.aspx?lang=cn)
![GPUdriver.png](/images/GPUdriver.png)
我下载的是deb文件nvidia-driver-local-repo-ubuntu2204-550.54.15_1.0-1_amd64.deb。执行：(这个过程中如果报错不是deb文件，可能是传输过程出现了损坏，需要重新传输)
```bash
sudo dpkg -i nvidia-driver-local-repo-ubuntu2204-550.54.15_1.0-1_amd64.deb
```
接下来执行：
```bash
sudo apt-get update
sudo apt-get install cuda-drivers
```
重新启动：
```bash
sudo reboot
```
查看是否安装成功，显示显卡版本和驱动版本。(deb文件装完那一步之后就可以试一下，试过但忘了能不能用，显示结果的窗口也没保存orz)
```bash
nvidia-smi
```
检查CUDA。
```bash
nvcc --version
```

### 3. 另一种方法：找到匹配的库安装
输入指令找到推荐的驱动：
```bash
sudo ubuntu-drivers devices
```
比如结果是这样的：
```bash
driver   : nvidia-driver-535-server-open - distro non-free
driver   : nvidia-driver-545-open - distro non-free
driver   : nvidia-driver-550-server - distro non-free
driver   : nvidia-driver-550-server-open - distro non-free
driver   : nvidia-driver-470-server - distro non-free
driver   : nvidia-driver-535-server - distro non-free
driver   : nvidia-driver-470 - distro non-free
driver   : nvidia-driver-535 - distro non-free recommended
driver   : nvidia-driver-535-open - distro non-free
driver   : nvidia-driver-545 - distro non-free
driver   : xserver-xorg-video-nouveau - distro free builtin
```
接下来运行：
```bash
sudo apt install nvidia-driver-535
```
安装完成后，nvidia-smi测试成功。
![nvidia&cuda_test.png](/images/nvidia&cuda_test.png)
## Pytorch安装

> [!NOTE] 操作环境
> Ubuntu-22.04 NVIDIA  A10 阿里云服务器 

来源于：[Linux服务器配置Python+PyTorch+CUDA深度学习环境_linux cuda环境配置-CSDN博客](https://blog.csdn.net/NSJim/article/details/115386936)
[Pytorch 如何检查PyTorch是否使用了GPU|极客教程 (geek-docs.com)](https://geek-docs.com/pytorch/pytorch-questions/1_pytorch_how_do_i_check_if_pytorch_is_using_the_gpu.html)
查看系统的python版本：
```bash
python3 -V
```
使用conda创建虚拟环境。
```bash
conda create -n yolov8 python=3.10.12
```
创建完成后进入虚拟环境：
```bash
conda activate yolov8
```
检查显卡驱动和CUDA都没有问题。
```bash
nvidia-smi
nvcc -V
```
打开pytorch官方网站[PyTorch](https://pytorch.org/)，查找对应配置的安装指令,CUDA版本是向下兼容的，选择低于本机CUDA版本的选项即可：
![pytorch.png](/images/pytorch.png)
输入给出的指令：
```bash
conda install pytorch torchvision torchaudio pytorch-cuda=12.1 -c pytorch -c nvidia
```
这一部分下载时间较长，中间可能会断，根据错误提示操作，多试几次。
安装完成后测试是否能使用。测试指令和输出结果如下
```python
(yolov8) ecs-user@iZ2ze124h883ysp83dcmgrZ:~$ python
Python 3.10.12 (main, Jul  5 2023, 18:54:27) [GCC 11.2.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
>>> import torch
>>> torch.cuda.is_available()
True
>>> torch.cuda.current_device()
0
>>> torch.cuda.device_count()
1
```

## Executorch安装

> [!NOTE] 操作环境
> 同一局域网下的多台香橙派4-lts Orange Pi 3.0.6 Bullseye with Linux 5.10.160-rk3399
> ip地址为192.168.0.110-192.168.0.113

参考：[Set up ExecuTorch | Arm Learning Paths](https://learn.arm.com/learning-paths/embedded-and-microcontrollers/rpi-llama3/executorch/)