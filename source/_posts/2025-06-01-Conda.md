---
title: Conda
date: 2025-06-01 10:34:58
updated: 2025-07-28 13:34:48
categories:
  - [服务器&嵌入式平台操作, 基础配置]
tags:
permalink: conda/
---

## miniconda安装

### 方法一

> [!NOTE] 操作环境
> Ubuntu 20.04 LTS 服务器

以下参考[【Conda】【Anaconda】Linux下安装Anaconda_anaconda linux the license agreement wasn't approv-CSDN博客](https://blog.csdn.net/RadiantJeral/article/details/110288050)
==$表示当前用户（root用户为#），为直观展示出进入虚拟环境后多了(环境名) $。注意不要输到命令行。==
1. 从官网上下载miniconda文件，Miniconda3-latest-Linux-x86_64.sh，并上传到服务器中。
安装指令：
```bash
$ bash Miniconda3-latest-Linux-x86_64.sh
```

2. 激活base虚拟环境：
```bash
$ source ~/miniconda3/bin/activate
(base) $
```

3. 初始化设置：
```bash
(base) $ conda init
```

4. 设置启动bash时不激活base环境：
```bash
(base) $ conda config --set auto_activate_base false
```

5. 重新启动后测试：
```bash
conda -V
```

6. 最后输出版本信息。

### 方法二

> [!NOTE] 操作环境
> Ubuntu-22.04.3 server 树莓派4

参考：[Miniconda — miniconda documentation](https://docs.conda.io/projects/miniconda/en/latest/)

```bash
mkdir -p ~/miniconda3
wget https://repo.anaconda.com/miniconda/Miniconda3-py38_4.9.2-Linux-aarch64.sh -O ~/miniconda3/miniconda.sh
bash ~/miniconda3/miniconda.sh -b -u -p ~/miniconda3
rm -rf ~/miniconda3/miniconda.sh
~/miniconda3/bin/conda init bash
```

## anaconda安装

> [!NOTE] 操作环境
> Ubuntu 22.04 LTS 服务器

来源于：[Linux系统安装Anaconda / 创建Python虚拟环境_anaconda linux-CSDN博客](https://blog.csdn.net/NSJim/article/details/134515198)
到官网[Unleash AI Innovation and Value | Anaconda](https://www.anaconda.com/)下载指定版本的文件，这边下载的文件名为Anaconda3-2024.02-1-Linux-x86_64.sh。
上传到服务器，输入：
```bash
bash Anaconda3-2024.02-1-Linux-x86_64.sh
```

安装完成后，出现是否初始化的选项。
![anaconda_init.png](/images/anaconda_init.png)

推荐输入yes，初始化完成后重新打开一个shell。这时会发现bash环境被激活。输入：
```bash
conda config --set auto_activate_base false
```

使得开机时不会激活bash环境。
输入下面指令退出环境：
```bash
conda deactivate
```

运行下面指令可以查看安装的conda版本：
```bash
conda -V
```

## 虚拟环境

创建虚拟环境
```bash
conda create -n myenv python=3.8
```
一些参数：
`-n` 虚拟环境名称
`-p` 指定虚拟环境路径
`-file` 从文本文件中读取包列表来安装

激活虚拟环境
```bash
conda activate myenv
```

退出虚拟环境
```bash
conda deactivate
```

删除虚拟环境
```bash
conda remove -n myenv --all
```

查看当前环境中已经安装的包
```bash
conda list
```

查看所有的虚拟环境
```bash
conda env list
```

两个虚拟环境的包对比：
步骤 1：导出 YML 文件
```bash
# 导出第一个环境  
conda env export --name env1 > env1.yml 
# 导出第二个环境 
conda env export --name env2 > env2.yml
```

或者用TXT对比：
```bash
# 激活第一个环境 
conda activate env1 conda list > env1_packages.txt 
# 激活第二个环境 
conda activate env2 conda list > env2_packages.txt
```

步骤 2：对比 YML 文件
使用文本编辑器（如 VS Code）或命令行工具对比：
```bash
diff env1.yml env2.yml
```
diff会逐行对比差异，结果很乱不太好用

所以写了个python脚本
```bash
def read_pip_list(file_path):
    with open(file_path, "r") as f:
        return [line.strip().split() for line in f if not line.startswith(("Package", "---"))]

def compare_pip_lists(list1, list2):
    set1 = {pkg[0]: pkg[1] for pkg in list1}
    set2 = {pkg[0]: pkg[1] for pkg in list2}

    added = set(set2.keys()) - set(set1.keys())
    removed = set(set1.keys()) - set(set2.keys())
    changed = {pkg for pkg in set1 if pkg in set2 and set1[pkg] != set2[pkg]}

    print("新增的包:")
    for pkg in sorted(added):
        print(f"  + {pkg} == {set2[pkg]}")

    print("\n删除的包:")
    for pkg in sorted(removed):
        print(f"  - {pkg} == {set1[pkg]}")

    print("\n版本变化的包:")
    for pkg in sorted(changed):
        print(f"  ⇄ {pkg} == {set1[pkg]} → {set2[pkg]}")

# 替换为你的文件路径
list1 = read_pip_list("siamlat_pip.txt")
list2 = read_pip_list("plat_pip.txt")
compare_pip_lists(list1, list2)

```

注意：YML 文件可能包含以下差异：
- 构建版本（如 py38h5...），建议使用 --no-builds 忽略：
```bash
conda env export --name env1 --no-builds > env1.yml
```

## 虚拟环境常用指令
更新虚拟环境的python版本

可以在当前环境中直接修改版本
```shell
conda install python=3.8
```