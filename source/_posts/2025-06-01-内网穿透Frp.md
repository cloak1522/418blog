---
title: 内网穿透—Frp
date: 2025-06-01 10:34:58
updated: 2024-12-22 20:53:39
categories:
  - [服务器&嵌入式平台操作, 工具]
tags:
permalink: 内网穿透—frp/
---

frp 是一款高性能的反向代理应用，专注于内网穿透。它支持多种协议，包括 TCP、UDP、HTTP、HTTPS 等，并且具备 P2P 通信功能。使用 frp，您可以安全、便捷地将内网服务暴露到公网，通过拥有公网 IP 的节点进行中转。
## SSH访问内网——服务器端配置
参考：[将内网linux服务器映射到云服务器上，使用ssh远程访问（frp内网穿透）_本地ip映射到云服务器-CSDN博客](https://blog.csdn.net/qq_38212715/article/details/129490126?spm=1001.2014.3001.5506)
[frp (gofrp.org)](https://gofrp.org/zh-cn/)

> [!NOTE] 操作环境
> 服务器端——阿里云服务器Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-71-generic x86_64)
> 客户端——香橙派
> 
### 1.云服务器设置
云服务器选择的是`阿里云`,需要开放服务器用于`frp连接`和`SSH登录`的端口，可以自行设置。这里frp开放默认的7000端口，SSH开放默认的6000端口和2001-2004端口，只需要在`入方向`开放。
![Frp-阿里云安全组配置.png](/images/Frp-阿里云安全组配置.png)
### 2.下载frp
在网站[Releases · fatedier/frp (github.com)](https://github.com/fatedier/frp/releases)上下载对应系统的frp。可以用以下指令显示系统全部信息
```bash
uname -a
```
![Frp-release.png](/images/Frp-release.png)
### 3.配置frps.toml文件
将上一步得到的安装包上传linux客户端并解压。
```bash
tar -zxvf frp_0.53.2_linux_amd64.tar.gz
```
进入文件夹并编辑配置文件`frps.toml`。
```bash
cd frp_0.53.2_linux_amd64
sudo vim frps.toml
```
修改bind_port为`frp连接`用到的端口
```bash
bindPort = 7000
```
### 4.使用systemd管理服务
如果 Linux 客户端上尚未安装 systemd，可以使用包管理器如 `yum`（适用于 CentOS/RHEL）或 `apt`（适用于 Debian/Ubuntu）来安装它：
```bash
# 使用 yum 安装 systemd（CentOS/RHEL）
yum install systemd

# 使用 apt 安装 systemd（Debian/Ubuntu）
apt install systemd
```
使用文本编辑器 (如 vim) 在 `/etc/systemd/system` 目录下创建一个 `frps.service` 文件，用于配置 frps 服务
```bash
sudo vim /etc/systemd/system/frps.service
```
写入内容
```bash
[Unit]
# 服务名称，可自定义
Description = frp server
After = network.target syslog.target
Wants = network.target

[Service]
Type = simple
# 启动frps的命令，需修改为您的frps的安装路径
ExecStart = /root/frp_0.53.2_linux_amd64/frps -c /root/frp_0.53.2_linux_amd64/frps.toml

[Install]
WantedBy = multi-user.target
```
systemd常用命令
```bash
# 启动frp
sudo systemctl start frps
# 停止frp
sudo systemctl stop frps
# 重启frp
sudo systemctl restart frps
# 查看frp状态
sudo systemctl status frps
# 设置服务开机自启动
sudo systemctl enable frps
```

## SSH访问内网——客户端配置

> [!NOTE] 操作环境
> 服务器端——阿里云服务器Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-71-generic x86_64)
> 客户端——香橙派
> 
### 1.下载frp
==可参照服务器配置篇==
### 2.配置frpc.toml文件
将上一步得到的安装包上传linux客户端并解压。
```
tar -zxvf frp_0.53.2_linux_arm64.tar.gz
```
进入文件夹并编辑配置文件`frpc.toml`。
```
cd frp_0.53.2_linux_arm64
sudo vim frpc.toml
```
修改目录下的配置文件,`云服务器ip`为59.110.168.138，`Frp端口`默认7000，`远程SSH端口`默认6000。根据实际修改文件中的这部分信息。
```
serverAddr = "59.110.168.138"
serverPort = 7000

[proxies](proxies)
name = "ubuntu"
type = "tcp"
localIP = "127.0.0.1"
localPort = 22
remotePort = 6000
```
### 3.使用systemd管理服务
参考：[frp 开机自启动，解决了网络依赖问题。_frp 搭建 start error: proxy [nacos_tcp] already exis-CSDN博客](https://blog.csdn.net/programguo/article/details/108435717?spm=1001.2014.3001.5506)

如果 Linux 客户端上尚未安装 systemd，可以使用包管理器如 `yum`（适用于 CentOS/RHEL）或 `apt`（适用于 Debian/Ubuntu）来安装它：
```bash
# 使用 yum 安装 systemd（CentOS/RHEL）
yum install systemd

# 使用 apt 安装 systemd（Debian/Ubuntu）
apt install systemd
```
使用文本编辑器 (如 vim) 在 `/etc/systemd/system` 目录下创建一个 `frpc.service` 文件，用于配置 frpc 服务
```bash
sudo vim /etc/systemd/system/frpc.service
```
写入内容
```text
[Unit]
# 服务名称，可自定义
Description = frp client
After = network.target syslog.target
Wants = network.target

[Service]
Type = simple `启动frps的命令，需修改为您的frps的安装路径`
ExecStart = /root/frp_0.53.2_linux_arm64/frpc -c /root/frp_0.53.2_linux_arm64/frpc.toml
 `防止客户端开机未联网，导致启动失败。设置1分钟后再次启动`
Restart= always
RestartSec=1min

[Install]
WantedBy = multi-user.target
```
systemd常用命令
```bash `启动frp`
sudo systemctl start frpc `停止frp`
sudo systemctl stop frpc `重启frp`
sudo systemctl restart frpc `查看frp状态`
sudo systemctl status frpc `设置服务开机自启动`
sudo systemctl enable frpc
```