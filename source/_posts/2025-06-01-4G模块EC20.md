---
title: 4G模块—EC20
date: 2025-06-01 10:34:58
updated: 2024-04-13 18:28:44
categories:
  - [服务器&嵌入式平台操作, 嵌入式&硬件]
tags:
permalink: 4g模块—ec20/
---

## Ubuntu Server使用EC20/EC25连接4G网络
来源于：[UbuntuServer使用EC20/EC25连接4G网络 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/540208588?utm_id=0&wd=&eqid=a9ba2b89000e396300000004647871ec)

> [!NOTE] 操作环境
> Ubuntu-22.04.3 server 树莓派4
> 
### 1.准备工作
Ubuntu Server系统（默认已经切换为root用户）——使用安装Ubuntu22.04.3 LTS Server版的树莓派4
EC20/EC25/EG25模块/开发板（USB接口）——USB接口EC20模块
4G手机卡——中国电信手机卡
### 2.安装依赖
由于Ubuntu Server版本不自带network-manager等组件，因此在使用4G连接前需要提前安装。
使用指令安装network-manager与modem-manager：
```bash
apt install network-manager
snap install modem-manager
```
### 3.配置调制解调器
安装完成后插入EC20的USB，*lsusb*指令查看是否能正常识别设备：
![EC20 result1.png](/images/EC20 result1.png)
成功识别后使用*nmcli -a*指令查看是否存在一个未连接gsm设备：
![EC20 result2.png](/images/EC20 result2.png)
使用*mmcli -L*查看4G设备的索引。如图所示，本设备中4G模块的索引为0：
![EC20 result3.png](/images/EC20 result3.png)
如果你的SIM卡设置了PIN码（使用*mmcli -m < idx >* 指令查看SIM等具体设置）可使用下面的指令解锁：
```bash
mmcli -i 0 --pin=<PIN>
```
例如：
```bash
mmcli -i 0 --pin=1212
```
解锁SIM的PIN后（如果设置了的话），进行设置蜂窝连接，使用下面的指令（该指令将配置应用到当前系统下所有调制解调器设备，即*mmcli -L*指令下的设备）:
```bash
nmcli c add type gsm ifname '*' con-name <name> apn <operator_apn>
```
其中：
< name >：为配置文的名称，可填写china-mobile
< operator_apn >：接入点名称，电信可填写cmnet
最终，指令如下：
```bash
nmcli c add type gsm ifname '*' con-name china-mobile apn cmnet
```

随后使用指令打开gsm网络：
```bash
nmcli r wwan on
```
打开自动连接设置，将< name >修改为前面输入的名称：
```bash
nmcli c modify <name> connection.autoconnect yes
```
最后，可使用*nmcli -a*指令查看，可看到4G连接已经成功上网：
![EC20 result4.png](/images/EC20 result4.png)

### 4.自己配置的运行结果
```bash
root@ubuntu:~# lsusb
Bus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
Bus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub
Bus 001 Device 003: ID 2c7c:0125 Quectel Wireless Solutions Co., Ltd. EC25 LTE modem
Bus 001 Device 002: ID 2109:3431 VIA Labs, Inc. Hub
Bus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub
root@ubuntu:~# nmcli -a
cdc-wdm0: disconnected
        "cdc-wdm0"
        gsm (option, qmi_wwan), hw

wlan0: disconnected
        "Broadcom BCM43438 combo and Bluetooth Low Energy"
        wifi (brcmfmac), E4:5F:01:12:68:BD, hw, mtu 1500

eth0: unmanaged
        "eth0"
        ethernet (bcmgenet), E4:5F:01:12:68:BC, hw, mtu 1500

lo: unmanaged
        "lo"
        loopback (unknown), 00:00:00:00:00:00, sw, mtu 65536

p2p-dev-wlan0: unmanaged
        "p2p-dev-wlan0"
        wifi-p2p, hw

Use "nmcli device show" to get complete information about known devices and
"nmcli connection show" to get an overview on active connection profiles.

Consult nmcli(1) and nmcli-examples(7) manual pages for complete usage details.
root@ubuntu:~# mmcli -L
    /org/freedesktop/ModemManager1/Modem/0 [QUALCOMM INCORPORATED] QUECTEL Mobile Broadband Module
root@ubuntu:~# nmcli c add type gsm ifname '*' con-name china-telecom apn ctnet
Connection 'china-telecom' (29bc84ae-084b-4416-aaba-5e2d33c443f1) successfully added.
root@ubuntu:~# nmcli c modify china-telecom connection.autoconnect yes
root@ubuntu:~# nmcli -a
cdc-wdm0: connected to china-telecom
        "cdc-wdm0"
        gsm (option, qmi_wwan), hw, iface wwan0, mtu 1500
        ip4 default, ip6 default
        inet4 100.164.112.82/30
        route4 100.164.112.80/30
        route4 0.0.0.0/0
        inet6 240e:428:2422:bf64:e111:11f2:964b:2d0d/64
        route6 240e:428:2422:bf64::/64
        route6 ::/0

wlan0: disconnected
        "Broadcom BCM43438 combo and Bluetooth Low Energy"
        wifi (brcmfmac), E4:5F:01:12:68:BD, hw, mtu 1500

eth0: unmanaged
        "eth0"
        ethernet (bcmgenet), E4:5F:01:12:68:BC, hw, mtu 1500

lo: unmanaged
        "lo"
        loopback (unknown), 00:00:00:00:00:00, sw, mtu 65536

p2p-dev-wlan0: unmanaged
        "p2p-dev-wlan0"
        wifi-p2p, hw

DNS configuration:
        servers: 219.150.32.132 123.150.150.150
        interface: wwan0

        servers: 240e:45::8888 240e:45::6666
        interface: wwan0

Use "nmcli device show" to get complete information about known devices and
"nmcli connection show" to get an overview on active connection profiles.
```